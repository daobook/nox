
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>教程 &#8212; Nox 2022.1.7 文档</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="配置和 API" href="config.html" />
    <link rel="prev" title="欢迎来到 Nox" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial">
<h1>教程<a class="headerlink" href="#tutorial" title="永久链接至标题">¶</a></h1>
<p>本教程将指导你完成安装、配置和运行 Nox。</p>
<section id="installation">
<h2>安装<a class="headerlink" href="#installation" title="永久链接至标题">¶</a></h2>
<p>Nox 可以通过 <a class="reference external" href="https://pip.readthedocs.org">pip</a> 轻松安装。</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 -m pip install nox</span>
</pre></div>
</div>
<p>你可能想使用 <a class="reference external" href="https://packaging.python.org/tutorials/installing-packages/#installing-to-the-user-site">user site</a>，以避免搞乱你的全局 Python 安装：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python3 -m pip install --user nox</span>
</pre></div>
</div>
<p>或者你可以更花哨一些，使用 <a class="reference external" href="https://packaging.python.org/guides/installing-stand-alone-command-line-tools/">pipx</a>：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pipx install nox</span>
</pre></div>
</div>
<p>无论如何，Nox 通常是 <em>全局</em> 范围内安装的，类似于 <code class="docutils literal notranslate"><span class="pre">tox</span></code>、<code class="docutils literal notranslate"><span class="pre">pip</span></code> 和其他类似工具。</p>
<p>如果你对在 <a class="reference external" href="https://www.docker.com/">docker</a> 中运行 <code class="docutils literal notranslate"><span class="pre">nox</span></code> 感兴趣，你可以使用 DockerHub 上的 <a class="reference external" href="https://hub.docker.com/r/thekevjames/nox">thekevjames/nox images</a>，其中包含所有 <code class="docutils literal notranslate"><span class="pre">nox</span></code> 版本和所有支持的 <code class="docutils literal notranslate"><span class="pre">python</span></code> 版本的构建。</p>
<p>如果你想在 <a class="reference external" href="https://github.com/features/actions">GitHub Actions</a> 中运行 <code class="docutils literal notranslate"><span class="pre">nox</span></code>，你可以使用 <a class="reference external" href="https://github.com/marketplace/actions/setup-nox">excitedleigh/setup-nox action</a>，它安装了最新的 <code class="docutils literal notranslate"><span class="pre">nox</span></code>，并使 GitHub Actions 环境提供的所有 Python 版本可用。</p>
</section>
<section id="writing-the-configuration-file">
<h2>编写配置文件<a class="headerlink" href="#writing-the-configuration-file" title="永久链接至标题">¶</a></h2>
<p>Nox 是通过你的项目目录中一个叫做 <code class="docutils literal notranslate"><span class="pre">noxfile.py</span></code> 的文件配置的。这个文件是一个 Python 文件，定义了一组 <em>sessions</em>。一个 <em>session</em> 是一个环境和一组在该环境中运行的命令。如果你对 tox 熟悉的话，session 类似于 <em>environments</em>。如果你熟悉 GNU Make，session 就类似于 <em>targets</em>。</p>
<p>会话是使用 <code class="docutils literal notranslate"><span class="pre">&#64;nox.session</span></code> 装饰器来声明的。这类似于 Flask 使用 <code class="docutils literal notranslate"><span class="pre">&#64;app.route</span></code> 的方式。</p>
<p>这是一个基本的 Noxfile，针对 <code class="docutils literal notranslate"><span class="pre">example.py</span></code> 运行 <a class="reference external" href="http://flake8.pycqa.org/en/latest/">flake8</a> （你可以自己创建 <code class="docutils literal notranslate"><span class="pre">example.py</span></code>）</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nox</span>

<span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">lint</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;flake8&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;flake8&quot;</span><span class="p">,</span> <span class="s2">&quot;example.py&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="running-nox-for-the-first-time">
<h2>第一次运行 Nox<a class="headerlink" href="#running-nox-for-the-first-time" title="永久链接至标题">¶</a></h2>
<p>现在你已经安装了 Nox 并有一个 Noxfile ，你可以运行 Nox 了！在终端打开你的项目目录，运行 <code class="docutils literal notranslate"><span class="pre">nox</span></code>。你应该看到像这样的东西：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>nox
<span class="go">nox &gt; Running session lint</span>
<span class="go">nox &gt; Creating virtualenv using python3.7 in .nox/lint</span>
<span class="go">nox &gt; pip install flake8</span>
<span class="go">nox &gt; flake8 example.py</span>
<span class="go">nox &gt; Session lint was successful.</span>
</pre></div>
</div>
<p><strong>✨ 你现在已经成功地第一次使用了 Nox！ ✨</strong></p>
<p>本教程的其余部分将带你了解你可能想用 Nox 做的其他普通事情。如果你愿意，你也可以跳到 <a class="reference internal" href="usage.html"><span class="doc">命令行用法</span></a> 和 <a class="reference internal" href="config.html"><span class="doc">配置和 API</span></a> 文档中。</p>
</section>
<section id="installing-dependencies">
<h2>安装依赖<a class="headerlink" href="#installing-dependencies" title="永久链接至标题">¶</a></h2>
<p>Nox 或多或少将 <code class="docutils literal notranslate"><span class="pre">session.install</span></code> 传递给 <code class="docutils literal notranslate"><span class="pre">pip</span></code>，所以你可以用通常的方式安装东西。这里有一些例子：</p>
<p>要一次安装一个或多个软件包：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="c1"># same as pip install pytest protobuf&gt;3.0.0</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">,</span> <span class="s2">&quot;protobuf&gt;3.0.0&quot;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>要安装 <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> 文件：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="c1"># same as pip install -r requirements.txt</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;requirements.txt&quot;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>如果你的项目是 Python 包，你想安装它：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="c1"># same as pip install .</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>在某些情况下，例如 Python 二进制扩展，你的软件包可能依赖于在 Python 生态系统之外编译的代码。要确保在安装过程中，低级别的依赖关系（例如 <code class="docutils literal notranslate"><span class="pre">libfoo</span></code>）是可用的</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run_always</span><span class="p">(</span>
        <span class="s2">&quot;cmake&quot;</span><span class="p">,</span> <span class="s2">&quot;-DCMAKE_BUILD_TYPE=Debug&quot;</span><span class="p">,</span>
        <span class="s2">&quot;-S&quot;</span><span class="p">,</span> <span class="n">libfoo_src_dir</span><span class="p">,</span>
        <span class="s2">&quot;-B&quot;</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">,</span>
        <span class="n">external</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run_always</span><span class="p">(</span>
        <span class="s2">&quot;cmake&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--build&quot;</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">,</span>
        <span class="s2">&quot;--config&quot;</span><span class="p">,</span> <span class="s2">&quot;Debug&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--target&quot;</span><span class="p">,</span> <span class="s2">&quot;install&quot;</span><span class="p">,</span>
        <span class="n">external</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="running-commands">
<h2>运行命令<a class="headerlink" href="#running-commands" title="永久链接至标题">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">session.run</span></code> 函数让你在会话的虚拟环境中运行命令。这里有几个例子：</p>
<p>你可以安装和运行 Python 工具：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>如果你想给程序传递更多的参数，只需在 <code class="docutils literal notranslate"><span class="pre">run</span></code> 中添加更多的参数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">,</span> <span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;tests&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>你也可以传递环境变量：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
        <span class="s2">&quot;pytest&quot;</span><span class="p">,</span>
        <span class="n">env</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;FLASK_DEBUG&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
        <span class="p">}</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>参见 <code class="xref py py-func docutils literal notranslate"><span class="pre">nox.session.Session.run()</span></code>，了解更多运行程序的选项和例子。</p>
</section>
<section id="selecting-which-sessions-to-run">
<h2>选择要运行的会话<a class="headerlink" href="#selecting-which-sessions-to-run" title="永久链接至标题">¶</a></h2>
<p>一旦你的 Nox 文件中有多个会话，你会发现 Nox 会默认运行它们。虽然这很有用，但通常一次只运行一个或两个是有用的。你可以使用 <code class="docutils literal notranslate"><span class="pre">--sessions</span></code> 参数（或 <code class="docutils literal notranslate"><span class="pre">-s</span></code>）来选择运行哪些会话。你可以使用 <code class="docutils literal notranslate"><span class="pre">--list</span></code> 参数来显示哪些会话是可用的，哪些将被运行。这里有一些例子：</p>
<p>这里有一个有三个会话的 Noxfile：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nox</span>

<span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">lint</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">docs</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>如果你只是运行 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--list</span></code> ，你会看到所有会话都被选中：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Sessions defined in noxfile.py:</span>

<span class="go">* test</span>
<span class="go">* lint</span>
<span class="go">* docs</span>

<span class="go">sessions marked with * are selected,</span>
<span class="go">sessions marked with - are skipped.</span>
</pre></div>
</div>
<p>如果你运行 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--list</span> <span class="pre">--sessions</span> <span class="pre">lint</span></code>，你会看到只有 lint 会话被选中：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Sessions defined in noxfile.py:</span>

<span class="go">- test</span>
<span class="go">* lint</span>
<span class="go">- docs</span>

<span class="go">sessions marked with * are selected,</span>
<span class="go">sessions marked with - are skipped.</span>
</pre></div>
</div>
<p>而如果你运行 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--sessions</span> <span class="pre">lint</span></code>，Nox 将只运行 lint 会话：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">nox &gt; Running session lint</span>
<span class="go">nox &gt; Creating virtualenv using python3 in .nox/lint</span>
<span class="go">nox &gt; ...</span>
<span class="go">nox &gt; Session lint was successful.</span>
</pre></div>
</div>
<p>在 noxfile 中，你可以指定一组默认的会话来运行。如果是这样，普通的 <code class="docutils literal notranslate"><span class="pre">nox</span></code> 调用将只触发某些会话：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nox</span>

<span class="n">nox</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">sessions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lint&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>如果你将此设置为空列表，Nox 默认不会运行任何会话，当用户没有指定要运行的会话时，会用 <code class="docutils literal notranslate"><span class="pre">--list</span></code> 输出打印一条有用的信息。</p>
<p>选择和运行会话的方法还有很多! 你可以在 <a class="reference internal" href="usage.html"><span class="doc">命令行用法</span></a> 中阅读更多关于调用 Nox 的信息。</p>
</section>
<section id="queuing-sessions">
<h2>会话队列<a class="headerlink" href="#queuing-sessions" title="永久链接至标题">¶</a></h2>
<p>如果你想从当前会话中排队（或 “notify”）另一个会话，你可以使用 <code class="docutils literal notranslate"><span class="pre">session.notify</span></code> 函数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">tests</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
    <span class="c1"># Here we queue up the test coverage session to run next</span>
    <span class="n">session</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s2">&quot;coverage&quot;</span><span class="p">)</span>

<span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">coverage</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;coverage&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;coverage&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>你可以排队任何你想要的会话，不仅仅是测试和覆盖会话，但这是一个非常常用的模式。</p>
<p>现在运行 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--session</span> <span class="pre">tests</span></code> 将运行测试会话，然后是覆盖会话。</p>
<p>你也可以传递被通知的会话位置参数：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">prepare_thing</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="n">thing_path</span> <span class="o">=</span> <span class="s2">&quot;./path/to/thing&quot;</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;thing&quot;</span><span class="p">,</span> <span class="n">thing_path</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">notify</span><span class="p">(</span><span class="s2">&quot;consume_thing&quot;</span><span class="p">,</span> <span class="n">posargs</span><span class="o">=</span><span class="p">[</span><span class="n">thing_path</span><span class="p">])</span>

<span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="k">def</span> <span class="nf">consume_thing</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="c1"># The &#39;consume&#39; command has the arguments</span>
    <span class="c1"># sent to it from the &#39;prepare_thing&#39; session</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;consume&quot;</span><span class="p">,</span> <span class="s2">&quot;thing&quot;</span><span class="p">,</span> <span class="n">session</span><span class="o">.</span><span class="n">posargs</span><span class="p">)</span>
</pre></div>
</div>
<p>注意，这只有在通过 <code class="docutils literal notranslate"><span class="pre">--session/-s</span></code> 标志选择要运行的会话时才会产生预期效果。如果你简单地运行 <code class="docutils literal notranslate"><span class="pre">nox</span></code>，所有选择的会话都会被运行。</p>
</section>
<section id="testing-against-different-and-multiple-pythons">
<h2>对不同的和多个 Python 进行测试<a class="headerlink" href="#testing-against-different-and-multiple-pythons" title="永久链接至标题">¶</a></h2>
<p>许多项目需要支持特定版本的 Python 或多个 Python 版本。你可以通过指定 <code class="docutils literal notranslate"><span class="pre">python</span></code> 到 <code class="docutils literal notranslate"><span class="pre">&#64;nox.session</span></code>，让 Nox 针对多个解释器运行你的会话。这里有一些例子：</p>
<p>如果你希望你的会话只针对单一版本的 Python 运行：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">python</span><span class="o">=</span><span class="s2">&quot;3.7&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>如果你想让你的会话针对多个版本的 Python 运行：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">python</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;2.7&quot;</span><span class="p">,</span> <span class="s2">&quot;3.6&quot;</span><span class="p">,</span> <span class="s2">&quot;3.7&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>你会注意到，运行 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--list</span></code> 将显示这一个会话已经扩展为三个不同的会话：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Sessions defined in noxfile.py:</span>

<span class="go">* test-2.7</span>
<span class="go">* test-3.6</span>
<span class="go">* test-3.7</span>
</pre></div>
</div>
<p>你可以使用 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--sessions</span> <span class="pre">test</span></code> 来运行所有的 <code class="docutils literal notranslate"><span class="pre">test</span></code> 会话，或者使用列表中显示的全名来运行单个会话，例如，<code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--sessions</span> <span class="pre">test-3.5</span></code>。关于选择会话的更多细节可以在 <a class="reference internal" href="usage.html"><span class="doc">命令行用法</span></a> 文档中找到。</p>
<p>你可以在 <a class="reference internal" href="config.html#virtualenv-config"><span class="std std-ref">配置会话的 virtualenv</span></a> 上阅读更多关于配置你的会话所使用的虚拟环境的信息。</p>
</section>
<section id="testing-with-conda">
<h2>用 conda 测试<a class="headerlink" href="#testing-with-conda" title="永久链接至标题">¶</a></h2>
<p>有些项目，尤其是数据科学界的项目，需要测试它们在 conda 环境下的工作。如果你想让你的会话在 conda 环境下运行：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span><span class="p">(</span><span class="n">venv_backend</span><span class="o">=</span><span class="s2">&quot;conda&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">session</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>用 conda 安装软件包：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">conda_install</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>用 pip 安装软件包到 conda 环境是可能的，但最好的做法是只用 <code class="docutils literal notranslate"><span class="pre">--no-deps</span></code> 选项来安装 pip 软件包。这样可以防止 pip 通过安装与 conda 已经安装的软件包不兼容的版本来破坏 conda 环境。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;contexter&quot;</span><span class="p">,</span> <span class="s2">&quot;--no-deps&quot;</span><span class="p">)</span>
<span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="s2">&quot;-e&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;--no-deps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;mamba&quot;</span></code> 也允许作为 <code class="docutils literal notranslate"><span class="pre">venv_backend</span></code> 的选择，它将使用/要求 <a class="reference external" href="https://github.com/mamba-org/mamba">mamba</a> 而不是 conda。</p>
</section>
<section id="parametrization">
<h2>参数化<a class="headerlink" href="#parametrization" title="永久链接至标题">¶</a></h2>
<p>就像 Nox 可以处理针对多个解释器的运行，Nox 也可以处理用不同的参数列表来运行你的会话，并使用 <a class="reference internal" href="config.html#nox.parametrize" title="nox.parametrize"><code class="xref py py-func docutils literal notranslate"><span class="pre">nox.parametrize()</span></code></a> 装饰器。</p>
<p>这里有一个使用参数化来测试两个不同版本的 Django 的简短例子：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@nox</span><span class="o">.</span><span class="n">session</span>
<span class="nd">@nox</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;django&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;1.9&quot;</span><span class="p">,</span> <span class="s2">&quot;2.0&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">django</span><span class="p">):</span>
    <span class="n">session</span><span class="o">.</span><span class="n">install</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;django==</span><span class="si">{</span><span class="n">django</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;pytest&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>如果你运行 <code class="docutils literal notranslate"><span class="pre">nox</span> <span class="pre">--list</span></code>，你会看到 Nox 将你的一个会话扩展为多个会话。每个参数值都有一个，你想把它传给你的会话：</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Sessions defined in noxfile.py:</span>

<span class="go">* test(django=&#39;1.9&#39;)</span>
<span class="go">* test(django=&#39;2.0&#39;)</span>
</pre></div>
</div>
<p><a class="reference internal" href="config.html#nox.parametrize" title="nox.parametrize"><code class="xref py py-func docutils literal notranslate"><span class="pre">nox.parametrize()</span></code></a> 的接口和用法有意类似于 <a class="reference external" href="https://pytest.org/latest/parametrize.html#_pytest.python.Metafunc.parametrize">pytest 的 parametrize</a>。它是 Nox 的一个非常强大的功能。你可以在 <a class="reference internal" href="config.html#parametrized"><span class="std std-ref">参数化会话</span></a> 上阅读更多关于参数化的信息并看到更多的例子。</p>
</section>
<section id="next-steps">
<h2>下一步<a class="headerlink" href="#next-steps" title="永久链接至标题">¶</a></h2>
<p>看看你! 你现在基本上已经是 Nox 的专家了! ✨</p>
<p>对于这一点，你可以：</p>
<ul class="simple">
<li><p>阅读更多的文档，如 <a class="reference internal" href="usage.html"><span class="doc">命令行用法</span></a> 和 <a class="reference internal" href="config.html"><span class="doc">配置和 API</span></a>。</p></li>
<li><p>给我们反馈或贡献，见 <a class="reference internal" href="CONTRIBUTING.html"><span class="doc">贡献</span></a>。</p></li>
</ul>
<p>玩得开心! 💜</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/alice.png" alt="Logo"/>
    
    <h1 class="logo logo-name">Nox</h1>
    
  </a>
</p>



<p class="blurb">Flexible test automation</p>








<h3>导航</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">教程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">安装</a></li>
<li class="toctree-l2"><a class="reference internal" href="#writing-the-configuration-file">编写配置文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-nox-for-the-first-time">第一次运行 Nox</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-dependencies">安装依赖</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-commands">运行命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="#selecting-which-sessions-to-run">选择要运行的会话</a></li>
<li class="toctree-l2"><a class="reference internal" href="#queuing-sessions">会话队列</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-against-different-and-multiple-pythons">对不同的和多个 Python 进行测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#testing-with-conda">用 conda 测试</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parametrization">参数化</a></li>
<li class="toctree-l2"><a class="reference internal" href="#next-steps">下一步</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="config.html">配置和 API</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">命令行用法</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Nox 秘籍</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">贡献</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">变更日志</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="上一章">欢迎来到 Nox</a></li>
      <li>Next: <a href="config.html" title="下一章">配置和 API</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">快速搜索</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="转向" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Alethea Katherine Flowers.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/theacodes/nox" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>